var Glazing={Animation:{increment:0.13,timeStep:0.02,method:function(t){return 1-Math.pow(Math.exp(-t),3)}},Keys:{CTRL:false},activeWindow:function(){return this.WindowManager.activeWindow}};Glazing.Window=function(a){this.initialize(a)};Glazing.Window.padding=6;Glazing.Window.defaultOptions=$H({id:0,className:'',width:400,height:300,resizable:true,minWidth:120,minHeight:0,draggable:true,content:'',titlebar:true,title:'Window',closable:true,closeAnimation:'implode',minimizable:true,maximizable:true,animated:true,statusbar:true,status:'',modal:false,url:null});Glazing.Window.prototype={readyToInitialize:function(){return!!Glazing.DragOverlay.screen},initialize:function(d){if(!this.readyToInitialize()){setTimeout(this.initialize.bind(this,d),1000);return false}if(this.window){return false}this.settings=$H({}).merge(Glazing.Window.defaultOptions).merge(d);if(typeof(this.settings.top)=='undefined'||typeof(this.settings.left)=='undefined'){var f=Glazing.WindowManager.getNewWindowPosition();if(typeof(this.settings.top)=='undefined'){this.settings.top=f.y}if(typeof(this.settings.left)=='undefined'){this.settings.left=f.x}}this.isMinimized=false;this.isMinimizing=false;this.isMaximized=false;this.isMaximizing=false;this.isRestoring=false;while($('glazing_'+this.settings.id)){this.settings.id++}var g=$w(this.settings.className);g.push('glazing');g.push('window');var h;if(this.settings.url){h='<iframe class="content" src="'+this.settings.url+'"></iframe>';if(this.settings.status===null){this.settings.status=this.settings.url}}else{h='<div class="content">'+this.settings.content+'</div>';if(this.settings.status===null){this.settings.status=''}}var i=new Insertion.Bottom(document.body,'      <table id="glazing_'+this.settings.id+'" class="'+g.join(' ')+'">        <tr>          <td class="top left"></td>          <td class="top"></td>          <td class="top right"></td>        </tr>        <tr class="middle">          <td class="left"></td>          <td class="center">            <div class="titlebar">              <div class="title"></div>              <div class="minimize"></div>              <div class="maximize"></div>              <div class="close"></div>            </div>            <div class="contentHolder"></div>            <div class="statusbar"></div>          </td>          <td class="right"></td>        </tr>        <tr>          <td class="bottom left"></td>          <td class="bottom"></td>          <td class="bottom right"></td>        </tr>      </table>');this.window=$('glazing_'+this.settings.id);this.topEdge=this.find('.top')[1];this.rightEdge=this.find('.middle .right')[0];this.leftEdge=this.find('.middle .left')[0];this.bottomEdge=this.find('.bottom')[1];this.topLeftCorner=this.find('.top.left')[0];this.topRightCorner=this.find('.top.right')[0];this.bottomLeftCorner=this.find('.bottom.left')[0];this.bottomRightCorner=this.find('.bottom.right')[0];this.middle=this.find('.middle')[0];this.titlebar=this.find('.titlebar')[0];this.title=this.find('.title')[0];this.closeButton=this.find('.close')[0];this.minimizeButton=this.find('.minimize')[0];this.maximizeButton=this.find('.maximize')[0];this.contentHolder=this.find('.contentHolder')[0];this.content=this.find('.content')[0];this.statusbar=this.find('.statusbar')[0];this.setPosition(this.settings.left,this.settings.top);this.setDimensions(this.settings.width,this.settings.height);this.setResizable(this.settings.resizable);this.setTitle(this.settings.title);if(!this.settings.titlebar){this.titlebar.hide()}this.setStatus(this.settings.status);if(!this.settings.statusbar){this.statusbar.hide()}this.setContent({url:this.settings.url,html:this.settings.content});$w('titlebar closeButton minimizeButton maximizeButton').each(function(a){this[a].observe('mouseover',this[a].addClassName.bind(this[a],'hover'));this[a].observe('mouseout',this[a].removeClassName.bind(this[a],'hover'))}.bind(this));this.contentHolder.observe('mousedown',this.makeActive.bind(this));this.statusbar.observe('mousedown',this.makeActive.bind(this));this.titlebar.observe('mousedown',function(e){Event.stop(e);this.makeActive();if(!this.canBeDragged()){return false}Glazing.WindowManager.recordMouseDownPosition(e);this.beginDragging()}.bind(this));$w('topEdge topLeftCorner topRightCorner        bottomEdge bottomLeftCorner bottomRightCorner        leftEdge rightEdge').each(function(a){this[a].observe('mousedown',function(e){Event.stop(e);this.makeActive();if(!this.canBeResized()){return false}Glazing.WindowManager.recordMouseDownPosition(e);this.beginResizing(a)}.bind(this))}.bind(this));$w('max min').each(function(b){var c=b.replace(/^(.)/,function(a){return a.toUpperCase()});this[b+'imizeButton'].observe('click',function(e){Event.stop(e);this.makeActive();if(this['canBe'+c+'imized']()){this[b+'imize']()}else if(this['is'+c+'imized']&&this.canBeRestored()){this.restore()}}.bind(this))}.bind(this));this.closeButton.observe('click',function(e){Event.stop(e);if(this.canBeClosed()){this.close()}}.bind(this));$w('maximize minimize close').each(function(a){this[a+'Button'].observe('mousedown',Event.stop)}.bind(this));Glazing.WindowManager.windows.append(this);this.makeActive();if(this.settings.modal){Glazing.Overlay.setOwner(this)}return true},find:function(a){return this.window.getElementsBySelector(a)},setPosition:function(a,b,c){if(typeof(c)=='undefined'){c=true}if(c){this.settings.left=a;this.settings.top=b}this.window.setStyle({left:a+'px',top:b+'px'})},center:function(){var a=Glazing.Utils.windowSize();var b=Glazing.Utils.scrollOffset();var c=this.window.getWidth();var d=this.window.getHeight();this.setPosition((a.x-c)/2+b.x,0.7*(a.y-d)/2+b.y,true)},setDimensions:function(a,b,c){if(typeof(c)=='undefined'){c=true}if(c){this.settings.width=a;this.settings.height=b}this.contentHolder.setStyle({height:b+'px',width:a+'px'})},fitToContent:function(){if(this.settings.url!==null){return}this.content.setStyle({border:'1px solid #000;'});this.setDimensions(this.content.getWidth()-2,this.content.getHeight()-2,true);this.content.setStyle({border:''})},edgeSizes:function(){return{top:this.titlebar.getHeight()+this.topEdge.getHeight(),right:this.rightEdge.getWidth(),bottom:this.statusbar.getHeight()+this.bottomEdge.getHeight(),left:this.leftEdge.getWidth()}},setTitle:function(a){this.settings.title=a;this.title.update(a.truncate(32))},setStatus:function(a){this.settings.status=a;this.statusbar.update(a)},setContent:function(a){var b,url;if(a.url){url=a.url.strip().replace(/^(?:http:\/\/)?(.*)$/g,'http://$1');this.settings.url=url;this.settings.content=null;this.statusbar.update(this.settings.status||url);b='<iframe class="content" src="'+url+'"></iframe>'}else{this.settings.url=null;this.settings.content=a.html;b='<div class="content">'+a.html+'</div>'}this.contentHolder.update(b);this.content=this.find('.content')[0]},makeActive:function(){Glazing.WindowManager.setActiveWindow(this)},canBeDragged:function(){return!Glazing.TaskSwitcher.active&&this.settings.draggable&&!this.isRestoring&&!this.isMaximized&&!this.isMaximizing},beginDragging:function(){Glazing.WindowManager.dragging=true;Glazing.DragOverlay.show({front:true})},stopDragging:function(){Glazing.WindowManager.dragging=false;this.settings.left=parseInt(this.window.getStyle('left'));this.settings.top=parseInt(this.window.getStyle('top'));Glazing.DragOverlay.hide()},setResizable:function(a){var b=!!a;this.settings.resizable=b;if(b){this.window.removeClassName('noresize')}else{this.window.addClassName('noresize')}},canBeResized:function(){return!Glazing.TaskSwitcher.active&&this.settings.resizable&&!this.isRestoring&&!this.isMinimized&&!this.isMinimizing&&!this.isMaximized&&!this.isMaximizing},beginResizing:function(a){Glazing.WindowManager.resizing=true;Glazing.WindowManager.resizingMode=a;Glazing.DragOverlay.show({front:true})},stopResizing:function(){Glazing.WindowManager.resizing=false;Glazing.WindowManager.resizingMode=null;this.settings.width=parseInt(this.contentHolder.getWidth());this.settings.height=parseInt(this.contentHolder.getHeight());this.settings.left=parseInt(this.window.getStyle('left'));this.settings.top=parseInt(this.window.getStyle('top'));Glazing.DragOverlay.hide()},canBeMinimized:function(){return!Glazing.TaskSwitcher.active&&this.settings.minimizable&&!this.isMinimized&&!this.isMinimizing&&!this.isRestoring&&!this.isMaximizing},canBeMaximized:function(){return!Glazing.TaskSwitcher.active&&this.settings.maximizable&&!this.isMaximized&&!this.isMaximizing&&!this.isRestoring&&!this.isMinimizing},canBeRestored:function(){return!Glazing.TaskSwitcher.active&&((this.isMinimized&&!this.isMinimizing)||(this.isMaximized&&!this.isMaximizing))&&!this.isRestoring},minimize:function(){this.isMaximized=false;this.window.addClassName('noresize');this.contentHolder.setStyle({overflow:'hidden'});if(!this.settings.animated){this.setDimensions(this.settings.width,0,false);this.setPosition(this.settings.left,this.settings.top,false);this.statusbar.setStyle({height:0});this.isMinimized=true;return}this.isMinimizing=true;this.animate({dimensions:{from:[this.contentHolder.getWidth(),this.contentHolder.getHeight()],to:[this.settings.width,0],persist:false},position:{from:[parseInt(this.window.getStyle('left')),parseInt(this.window.getStyle('top'))],to:[this.settings.left,this.settings.top],persist:false},onComplete:function(){this.isMinimizing=false;this.isMinimized=true;this.statusbar.setStyle({height:0})}})},maximize:function(){this.window.addClassName('noresize');if(this.isMinimized){this.statusbar.setStyle({height:''});this.contentHolder.setStyle({overflow:''})}this.isMinimized=false;var a=Glazing.Utils.windowSize();var b=Glazing.Utils.scrollOffset();var c=this.edgeSizes();var d=a.x-2*Glazing.Window.padding-c.left-c.right-18,height=a.y-2*Glazing.Window.padding-c.top-c.bottom-18,top=b.y+Glazing.Window.padding,left=b.x+Glazing.Window.padding;if(!this.settings.animated){this.setDimensions(d,height,false);this.setPosition(left,top,false);this.isMaximized=true;return}this.isMaximizing=true;this.animate({dimensions:{from:[this.contentHolder.getWidth(),this.contentHolder.getHeight()],to:[d,height],persist:false},position:{from:[parseInt(this.window.getStyle('left')),parseInt(this.window.getStyle('top'))],to:[left,top],persist:false},onComplete:function(){this.isMaximizing=false;this.isMaximized=true}})},restore:function(){this.isMinimized=false;this.isMaximized=false;this.setResizable(this.settings.resizable);this.statusbar.setStyle({height:''});if(!this.settings.animated){this.setDimensions(this.settings.width,this.settings.height);this.setPosition(this.settings.left,this.settings.top);return}this.isRestoring=true;this.animate({dimensions:{from:[this.contentHolder.getWidth(),this.contentHolder.getHeight()],to:[this.settings.width,this.settings.height],persist:false},position:{from:[parseInt(this.window.getStyle('left')),parseInt(this.window.getStyle('top'))],to:[this.settings.left,this.settings.top],persist:false},onComplete:function(){this.isRestoring=false;this.contentHolder.setStyle({overflow:''})}})},canBeClosed:function(){return this.settings.closable},close:function(){Glazing.WindowManager.removeWindow(this);this.contentHolder.setStyle({overflow:'hidden'});if(!this.settings.animated){this.window.remove();return}if(this.settings.closeAnimation=='fade'){this.animate({opacity:{from:1,to:0},onComplete:this.window.remove.bind(this.window)});return}var a,height,left,top;switch(this.settings.closeAnimation){case'implode':a=0;height=0;left=parseInt(this.window.getStyle('left'))+0.5*this.contentHolder.getWidth();top=parseInt(this.window.getStyle('top'))+0.5*this.contentHolder.getHeight();break;case'explode':a=2*this.contentHolder.getWidth();height=2*this.contentHolder.getHeight();left=parseInt(this.window.getStyle('left'))-0.25*a;top=parseInt(this.window.getStyle('top'))-0.25*height;break}this.animate({dimensions:{from:[this.contentHolder.getWidth(),this.contentHolder.getHeight()],to:[a,height],persist:false},position:{from:[parseInt(this.window.getStyle('left')),parseInt(this.window.getStyle('top'))],to:[left,top],persist:false},opacity:{from:1,to:0},onComplete:this.window.remove.bind(this.window)})},animate:function(e){var t=0,loop,k,prop;loop=new PeriodicalExecuter(function(d){k=Glazing.Animation.method(t);if(k>0.999){d.stop();$w('dimensions position').each(function(b){var c,Property=b.replace(/^(.)/,function(a){return a.toUpperCase()});if(c=e[b]){this['set'+Property](c.to[0],c.to[1],!!c.persist)}}.bind(this));if(prop=e.opacity){this.window.setStyle({opacity:prop.to})}if(e.onComplete){e.onComplete.bind(this)()}}else{$w('dimensions position').each(function(b){var c,Property=b.replace(/^(.)/,function(a){return a.toUpperCase()});if(c=e[b]){this['set'+Property](c.from[0]+k*(c.to[0]-c.from[0]),c.from[1]+k*(c.to[1]-c.from[1]),!!c.persist)}}.bind(this));if(prop=e.opacity){this.window.setStyle({opacity:prop.from+k*(prop.to-prop.from)})}}t+=Glazing.Animation.increment}.bind(this),Glazing.Animation.timeStep)},isAccessible:function(){var a=parseInt(Glazing.Overlay.screen.getStyle('zIndex'))||0;return!Glazing.Overlay.active||parseInt(this.window.getStyle('zIndex'))>=a}};$w('Alert Confirm').each(function(d){Glazing[d]=function(a,b){this.initializeModal(a,b)};Object.extend(Glazing[d].prototype,Glazing.Window.prototype);Object.extend(Glazing[d].prototype,{initializeModal:function(a,b){if(!this.readyToInitialize()){setTimeout(this.initializeModal.bind(this,a,b),1000);return false}if(this.window){return false}b=b||{};b=$H({className:'modal '+d.toLowerCase(),draggable:false,resizable:false,width:340,minimizable:false,maximizable:false,closable:false,closeAnimation:'explode',titlebar:false,statusbar:false,modal:true,onOK:b.onClose||function(){},onCancel:function(){},ok:'OK',cancel:'Cancel'}).merge(b);b.onOK=b['on'+b.ok]||b.onOK;b.onCancel=b['on'+b.cancel]||b.onCancel;var c=(d=='Confirm')?'<button class="cancel">'+b.cancel+'</button>':'';a='        <div class="modalContent">'+a+'</div>        <div class="modalButtons">          <button class="ok">'+b.ok+'</button>          '+c+'        </div>';b.content=a;this.initialize(b);this.addEvents();this.setDimensions(this.content.getWidth(),this.content.getHeight());this.contentHolder.setStyle({overflow:'hidden'});this.center()},addEvents:function(){this.ok=this.find('.ok')[0];this.ok.observe('click',function(e){Event.stop(e);this.settings.onOK();this.close()}.bind(this));this.ok.focus();if(d=='Confirm'){this.cancel=this.find('.cancel')[0];this.cancel.observe('click',function(e){Event.stop(e);this.settings.onCancel();this.close()}.bind(this))}this.find('button').each(function(a){a.observe('mouseover',a.addClassName.bind(a,'hover'));a.observe('mouseout',a.removeClassName.bind(a,'hover'))})}})});Event.observe(window,'load',function(){Event.observe(document,'mousemove',function(e){var a=Event.pointerX(e),mY=Event.pointerY(e);var b=Glazing.WindowManager.activeWindow,resizingMode=Glazing.WindowManager.resizingMode;var c,diffX,diffY;var d,minWidth;var w,h,horiz,vert;if(c=Glazing.WindowManager.mouseDownPosition){diffX=a-c.x;diffY=mY-c.y}switch(true){case Glazing.WindowManager.dragging:b.setPosition(b.settings.left+diffX,b.settings.top+diffY,false);break;case Glazing.WindowManager.resizing:minWidth=b.settings.minWidth;d=b.settings.minHeight;switch(true){case!!resizingMode.match(/top/i):h=b.settings.height-diffY;vert=(h>=d)?[b.settings.top+diffY,h]:[b.settings.top+b.settings.height-d,d];break;case!!resizingMode.match(/bottom/i):h=b.settings.height+diffY;if(h<d){h=d}break}switch(true){case!!resizingMode.match(/left/i):w=b.settings.width-diffX;horiz=(w>=minWidth)?[b.settings.left+diffX,w]:[b.settings.left+b.settings.width-minWidth,minWidth];break;case!!resizingMode.match(/right/i):w=b.settings.width+diffX;if(w<minWidth){w=b.settings.minWidth}break}switch(Glazing.WindowManager.resizingMode){case'topEdge':b.setPosition(b.settings.left,vert[0],false);b.setDimensions(b.settings.width,vert[1],false);break;case'topLeftCorner':b.setPosition(horiz[0],vert[0],false);b.setDimensions(horiz[1],vert[1],false);break;case'topRightCorner':b.setPosition(b.settings.left,vert[0],false);b.setDimensions(w,vert[1],false);break;case'bottomEdge':b.setDimensions(b.settings.width,h,false);break;case'bottomLeftCorner':b.setPosition(horiz[0],b.settings.top,false);b.setDimensions(horiz[1],h,false);break;case'bottomRightCorner':b.setDimensions(w,h,false);break;case'leftEdge':b.setPosition(horiz[0],b.settings.top,false);b.setDimensions(horiz[1],b.settings.height,false);break;case'rightEdge':b.setDimensions(w,b.settings.height,false);break}break}});Event.observe(document,'mouseup',function(e){switch(true){case Glazing.WindowManager.dragging:Glazing.WindowManager.activeWindow.stopDragging();break;case Glazing.WindowManager.resizing:Glazing.WindowManager.activeWindow.stopResizing();break}});Object.extend(Event,{KEY_CTRL:17,KEY_G:71});Event.observe(document,'keydown',function(e){if(Glazing.Keys.CTRL){switch(e.keyCode){case Event.KEY_DOWN:Event.stop(e);Glazing.TaskSwitcher.prev();break;case Event.KEY_UP:Event.stop(e);Glazing.TaskSwitcher.next();break}}if(e.keyCode==Event.KEY_CTRL){Glazing.Keys.CTRL=true}});Event.observe(document,'keyup',function(e){if(e.keyCode==Event.KEY_CTRL){Glazing.Keys.CTRL=false;if(Glazing.TaskSwitcher.active){Glazing.TaskSwitcher.exit()}}})});Glazing.OverlayClass=function(){};Glazing.OverlayClass.prototype={color:'#000000',opacity:0.4,active:false,owner:null,belongsTo:function(a){return this.owner==a},setOwner:function(a){this.owner=a;this.show({behind:a})},setSize:function(){var a=Glazing.Utils.documentSize();var b=Glazing.Utils.windowSize();var c=a.x;var d=(a.y>b.y)?a.y:b.y;this.screen.setStyle({width:c+'px',height:d+'px'})},bringToFront:function(){this.setSize();var a=Glazing.WindowManager.activeWindow;this.screen.setStyle({zIndex:a?parseInt(a.window.getStyle('zIndex'))+1:Glazing.WindowManager.baseZindex})},positionBehind:function(a){this.setSize();var b=(a=='owner')?this.owner.window:a.window||a;var z=b.getStyle('zIndex')||0;this.screen.setStyle({zIndex:z})},show:function(b){this.setSize();b=b||{};if(b.front){this.bringToFront()}if(b.behind){this.positionBehind(b.behind)}if(typeof(b.opacity)=='undefined'){b.opacity=this.opacity}if(!this.active){this.active=true;this.screen.setStyle({opacity:0.001,display:'block',backgroundColor:this.color});var t=0,loop,k;loop=new PeriodicalExecuter(function(a){k=Glazing.Animation.method(t);if(k>0.999){a.stop();this.screen.setStyle({opacity:b.opacity||0.001})}else{this.screen.setStyle({opacity:k*b.opacity||0.001})}t+=Glazing.Animation.increment}.bind(this),Glazing.Animation.timeStep)}},hide:function(){this.active=false;this.owner=null;this.screen.setStyle({display:'none'})}};Glazing.Overlay=new Glazing.OverlayClass();Glazing.DragOverlay=new Glazing.OverlayClass();Glazing.DragOverlay.opacity=0;Event.observe(window,'load',function(){['','Drag'].each(function(a){var b=0;while($('glazingOverlay'+b)){b++}var c=new Insertion.Top(document.body,'<div id="glazingOverlay'+b+'"></div>');Glazing[a+'Overlay'].screen=$('glazingOverlay'+b);Glazing[a+'Overlay'].screen.setStyle({display:'none',position:'absolute',left:'0',top:'0'});Event.observe(window,'resize',function(e){if(Glazing[a+'Overlay'].active){Glazing[a+'Overlay'].setSize()}})})});Glazing.LinkedList=function(){};Glazing.LinkedList.prototype={length:0,first:null,last:null,each:function(a){var b=this.first,n=this.length;for(var i=0;i<n;i++){a(b,i);b=b.next}},at:function(i){if(!(i>=0&&i<this.length)){return null}var a=this.first;while(i--){a=a.next}return a},randomNode:function(){var n=Math.floor(Math.random()*this.length);return this.at(n)},indexOf:function(a){var b=this.first,n=this.length;for(var i=0;i<n;i++){if(b==a){return i}b=b.next}return null},toArray:function(){var a=[],node=this.first,n=this.length;while(n--){a.push(node.data||node);node=node.next}return a}};Glazing.LinkedList.Circular=function(){};Object.extend(Glazing.LinkedList.Circular.prototype,Glazing.LinkedList.prototype);Object.extend(Glazing.LinkedList.Circular.prototype,{append:function(a){if(this.first===null){a.prev=a;a.next=a;this.first=a;this.last=a}else{a.prev=this.last;a.next=this.first;this.first.prev=a;this.last.next=a;this.last=a}this.length++},prepend:function(a){if(this.first===null){this.append(a);return}else{a.prev=this.last;a.next=this.first;this.first.prev=a;this.last.next=a;this.first=a}this.length++},insertAfter:function(a,b){b.prev=a;b.next=a.next;a.next.prev=b;a.next=b;if(b.prev==this.last){this.last=b}this.length++},insertBefore:function(a,b){b.prev=a.prev;b.next=a;a.prev.next=b;a.prev=b;if(b.next==this.first){this.first=b}this.length++},remove:function(a){if(this.length>1){a.prev.next=a.next;a.next.prev=a.prev;if(a==this.first){this.first=a.next}if(a==this.last){this.last=a.prev}}else{this.first=null;this.last=null}a.prev=null;a.next=null;this.length--}});Glazing.WindowManager={windows:new Glazing.LinkedList.Circular(),activeWindow:null,mouseDownPosition:null,dragging:false,resizing:false,resizingMode:null,baseX:50,baseY:50,stepX:30,stepY:30,step:0,maxSteps:6,baseZindex:1000,recordMouseDownPosition:function(e){Glazing.WindowManager.mouseDownPosition={x:Event.pointerX(e),y:Event.pointerY(e)}},getNewWindowPosition:function(){var a={x:this.baseX+this.step*this.stepX,y:this.baseY+this.step*this.stepY};this.step++;if(this.step>=this.maxSteps){this.step=0}return a},setActiveWindow:function(b){if(b!=this.activeWindow){this.windows.remove(b);this.windows.append(b);this.windows.each(function(a,i){a.window.setStyle({zIndex:this.baseZindex+i})}.bind(this));this.activeWindow=b;if(b.settings.modal){Glazing.Overlay.setOwner(b)}else if(Glazing.Overlay.owner){Glazing.Overlay.show({behind:'owner'})}}this.hideSelects()},removeWindow:function(a){if(Glazing.Overlay.active&&Glazing.Overlay.belongsTo(a)){var b=false,node=a,n=0,k=this.windows.indexOf(a);while(!b&&n<k){node=node.prev;if(node.settings.modal){Glazing.Overlay.setOwner(node);b=true}n++}if(!b){Glazing.Overlay.hide()}}this.windows.remove(a);if(a==this.activeWindow&&this.windows.length>0){this.setActiveWindow(this.windows.last)}this.hideSelects()},minimizeAll:function(){this.windows.each(function(a){if(a.canBeMinimized()){a.minimize()}})},hideSelects:function(){if(!navigator.userAgent.match(/MSIE 6/)){return}var b=$$('select');if(b.length===0){return}var c=null;Glazing.WindowManager.windows.each(function(a){var z=a.window.getStyle('zIndex')||0;if(c===null){c=z}if(z<c){c=z}});b.each(function(a){a.setStyle({visibility:(a.getStyle('zIndex')<=c)&&(c!==null)?'hidden':'visible'})})}};Glazing.TaskSwitcher={active:false,currentWindow:null,fadeOpacity:0.15,exit:function(){var b=Glazing.WindowManager;this.active=false;if(this.currentWindow){this.currentWindow.makeActive();if(this.currentWindow.isMinimized){this.currentWindow.restore()}}this.currentWindow=null;b.windows.each(function(a){a.window.setStyle({opacity:1})})}};$w('next prev').each(function(d){Glazing.TaskSwitcher[d]=function(){var b=Glazing.WindowManager;var c=false,n=0,k=b.windows.length-1;if(!this.active){this.active=true;this.currentWindow=b.activeWindow;while(!c&&n<k){this.currentWindow=this.currentWindow[d];c=this.currentWindow.isAccessible();n++}if(c){b.windows.each(function(a){if(a!=this.currentWindow){a.window.setStyle({opacity:this.fadeOpacity||0.001})}}.bind(this))}else{this.currentWindow=null;this.exit()}}else{this.currentWindow.window.setStyle({opacity:this.fadeOpacity||0.001});while(!c&&n<k){this.currentWindow=this.currentWindow[d];c=this.currentWindow.isAccessible();n++}this.currentWindow.window.setStyle({opacity:1})}}});Glazing.Utils={windowSize:function(){var x,y;if(self.innerHeight){x=self.innerWidth;y=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){x=document.documentElement.clientWidth;y=document.documentElement.clientHeight}else if(document.body){x=document.body.clientWidth;y=document.body.clientHeight}return{x:x,y:y}},documentSize:function(){var x,y;var a=document.body.scrollHeight;var b=document.body.offsetHeight;if(a>b){x=document.body.scrollWidth;y=document.body.scrollHeight}else{x=document.body.offsetWidth;y=document.body.offsetHeight}return{x:x,y:y}},scrollOffset:function(){var x,y;if(self.pageYOffset){x=self.pageXOffset;y=self.pageYOffset}else if(document.documentElement&&document.documentElement.scrollTop){x=document.documentElement.scrollLeft;y=document.documentElement.scrollTop}else if(document.body){x=document.body.scrollLeft;y=document.body.scrollTop}return{x:x,y:y}}};Glazing.enableGlobals=function(b){b=$H(b||{});var c=$w('Window Alert Confirm Overlay WindowManager TaskSwitcher');if(b.only){c=c.findAll(function(a){return b.only.include(a)})}if(b.except){c=c.reject(function(a){return b.except.include(a)})}c.each(function(a){window[a]=Glazing[a]})};